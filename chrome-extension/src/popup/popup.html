<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Meeting Minutes Automator</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <h1>
    <span class="status-badge" id="authBadge"></span>
    Meeting Minutes Automator
  </h1>

  <!-- Notification Area -->
  <div class="notification" id="notification" data-testid="notification"></div>

  <!-- Auth Section -->
  <div class="auth-section">
    <div class="auth-status">
      <span class="auth-status-text" id="authStatusText">Google Docs: 未連携</span>
    </div>

    <!-- Auth Button (Connect/Disconnect) -->
    <button class="btn btn-primary hidden" id="authButton" data-testid="login-button">
      Google アカウントと連携
    </button>
    <button class="btn btn-danger hidden" id="disconnectButton" data-testid="logout-button">
      連携を解除
    </button>

    <!-- Guide Text -->
    <div class="guide" id="authGuide">
      Googleアカウントと連携すると、文字起こし結果をGoogle Docsに自動保存できます。
    </div>
  </div>

  <!-- Settings Section (Phase 5 - Task 13.1) -->
  <div class="settings-section hidden" id="settingsSection" data-testid="settings-section">
    <div class="settings-header">
      同期設定
    </div>

    <!-- Document ID -->
    <div class="setting-row document-id-row">
      <div>
        <div class="setting-label">ドキュメントID</div>
        <div class="setting-description">docs.google.com/document/d/&lt;ID&gt;/edit の &lt;ID&gt;</div>
      </div>
      <div class="document-id-controls">
        <input type="text" id="settingDocumentId" placeholder="Document ID" class="test-input" data-testid="doc-id-input" name="documentId">
        <button class="btn btn-primary" id="saveDocumentId">保存</button>
      </div>
    </div>

    <!-- Enable/Disable Sync -->
    <div class="setting-row">
      <div>
        <div class="setting-label">Google Docs同期</div>
        <div class="setting-description">文字起こしをGoogle Docsに自動保存</div>
      </div>
      <label class="toggle-switch">
        <input type="checkbox" id="settingEnabled" data-testid="sync-toggle" checked>
        <span class="toggle-slider"></span>
      </label>
    </div>

    <!-- Show Timestamp -->
    <div class="setting-row">
      <div>
        <div class="setting-label">タイムスタンプ表示</div>
        <div class="setting-description">各行に時刻を表示</div>
      </div>
      <label class="toggle-switch">
        <input type="checkbox" id="settingTimestamp" checked>
        <span class="toggle-slider"></span>
      </label>
    </div>

    <!-- Show Speaker -->
    <div class="setting-row">
      <div>
        <div class="setting-label">話者名表示</div>
        <div class="setting-description">話者名を表示（実験的機能）</div>
      </div>
      <label class="toggle-switch">
        <input type="checkbox" id="settingSpeaker">
        <span class="toggle-slider"></span>
      </label>
    </div>

    <!-- Buffering Time -->
    <div class="setting-row">
      <div>
        <div class="setting-label">バッファリング時間</div>
        <div class="setting-description">同期前の待機時間</div>
      </div>
      <div class="range-container">
        <input type="range" id="settingBuffering" class="range-input" min="1" max="5" value="3">
        <span class="range-value" id="bufferingValue">3秒</span>
      </div>
    </div>
  </div>

  <!-- Connection Status (MVP0) -->
  <div class="connection-section" data-testid="connection-status">
    <p class="no-margin">Tauri接続: <span class="connection-dot" id="connectionDot"></span><span id="status" data-testid="ws-status">確認中...</span></p>
    <div class="connection-actions">
      <button class="btn btn-secondary" id="wsConnectButton">接続開始</button>
      <button class="btn btn-secondary" id="wsDisconnectButton">切断</button>
    </div>
  </div>

  <!-- Integration Test Section -->
  <div class="auth-section hidden" id="testSection">
    <div class="test-header">🧪 Integration Test</div>
    <input type="text" id="documentIdInput" placeholder="Document ID" class="test-input">
    <button class="btn btn-primary" id="testButton">Run Integration Test</button>
    <div class="guide show test-guide">
      DevTools Console (F12) で結果を確認してください。<br>
      Document ID: docs.google.com/document/d/<strong>{ID}</strong>/edit
    </div>
  </div>

  <div class="footer">
    MVP2 - Google Docs Integration
  </div>

  <script src="popup.js"></script>
</body>
</html>
